# Механизм тегирования данных

## Классификация данных по тегам

### Уровни конфиденциальности

#### 1. КРИТИЧНО (CRITICAL)
**Описание:** Данные, утечка которых может нанести критический ущерб.

**Тег:** `confidentiality:critical`

**Примеры:**
- Медицинские диагнозы
- Результаты анализов
- Хронические заболевания
- Финансовые данные пациентов

**Требования к защите:**
- Обязательное шифрование (AES-256)
- Строгий контроль доступа (RBAC + ABAC)
- Полный аудит всех операций
- Автоматическое обнаружение утечек

#### 2. ВЫСОКИЙ (HIGH)
**Описание:** Данные, утечка которых может нанести значительный ущерб.

**Тег:** `confidentiality:high`

**Примеры:**
- ФИО, дата рождения
- Адрес прописки
- Контактные данные (телефон, email)
- История лечения

**Требования к защите:**
- Шифрование (AES-256)
- Контроль доступа (RBAC)
- Аудит операций
- Мониторинг доступа

#### 3. СРЕДНИЙ (MEDIUM)
**Описание:** Данные, утечка которых может нанести умеренный ущерб.

**Тег:** `confidentiality:medium`

**Примеры:**
- Данные о записях к специалистам
- Расписание работы специалистов
- Общая информация о пациентах (без персональных данных)

**Требования к защите:**
- Шифрование при передаче (TLS)
- Базовый контроль доступа
- Логирование операций

#### 4. НИЗКИЙ (LOW)
**Описание:** Данные, утечка которых нанесёт минимальный ущерб.

**Тег:** `confidentiality:low`

**Примеры:**
- Агрегированная статистика
- Обезличенные данные для аналитики
- Публичная информация

**Требования к защите:**
- Базовая защита
- Контроль доступа на уровне системы

## Категории данных

### PII (Personally Identifiable Information)
**Тег:** `category:pii`

**Примеры:**
- ФИО
- Дата рождения
- Паспортные данные
- Адрес

### PHI (Protected Health Information)
**Тег:** `category:phi`

**Примеры:**
- Медицинские диагнозы
- Результаты анализов
- История лечения
- Назначенные препараты

### Financial Data
**Тег:** `category:financial`

**Примеры:**
- Данные о платежах
- Счета и квитанции
- Финансовая история

### Administrative Data
**Тег:** `category:administrative`

**Примеры:**
- Данные о записях
- Расписание специалистов
- Журналы приёма

## Состояния данных

### At Rest (в покое)
**Тег:** `state:at_rest`

**Требования:**
- Шифрование диска (FDE)
- Шифрование базы данных
- Шифрование файлов

### In Transit (при передаче)
**Тег:** `state:in_transit`

**Требования:**
- TLS 1.3
- VPN для удалённого доступа
- Шифрование API-коммуникаций

### In Use (в процессе использования)
**Тег:** `state:in_use`

**Требования:**
- Шифрование на уровне приложения
- Защищённые зоны выполнения (TEE)
- Минимизация времени хранения в памяти

## Примеры тегов для данных

### Медицинская карта пациента:
```
confidentiality:critical
category:phi
category:pii
state:at_rest
retention:10_years
access:medical_staff_only
encryption:required
audit:required
```

### Результаты анализов:
```
confidentiality:critical
category:phi
state:at_rest
retention:5_years
access:medical_staff_only
encryption:required
audit:required
masking:required_for_testing
```

### Данные о записи к врачу:
```
confidentiality:medium
category:administrative
state:at_rest
retention:3_years
access:reception_staff,medical_staff
encryption:required
audit:recommended
```

### Контактные данные пациента:
```
confidentiality:high
category:pii
state:at_rest
retention:5_years
access:reception_staff,medical_staff
encryption:required
audit:required
```

## Инструменты для тегирования

### 1. Apache Atlas
**Применение:** Управление метаданными и тегирование в экосистеме Hadoop

**Преимущества:**
- Автоматическая классификация
- Интеграция с Hadoop
- Отслеживание Data Lineage

### 2. Collibra Data Intelligence
**Применение:** Централизованное управление данными и тегирование

**Преимущества:**
- Автоматическое обнаружение данных
- Управление метаданными
- Визуализация потоков данных

### 3. BigID
**Применение:** Автоматическое обнаружение и классификация конфиденциальных данных

**Преимущества:**
- Машинное обучение для классификации
- Автоматическое тегирование
- Интеграция с различными системами

### 4. OneTrust
**Применение:** Управление конфиденциальностью и тегирование данных

**Преимущества:**
- Соответствие требованиям GDPR, 152-ФЗ
- Управление согласиями
- Автоматическая классификация

### 5. Informatica Data Catalog
**Применение:** Каталог данных с автоматическим тегированием

**Преимущества:**
- Автоматическая маркировка
- Интеграция с различными источниками
- Управление метаданными

## Политики на основе тегов

### Политика шифрования:
```
IF confidentiality:critical OR confidentiality:high THEN
  encryption:required (AES-256)
END IF
```

### Политика доступа:
```
IF category:phi THEN
  access:medical_staff_only
  audit:required
END IF
```

### Политика хранения:
```
IF category:phi THEN
  retention:10_years
  deletion:secure
END IF
```

### Политика маскирования:
```
IF category:phi OR category:pii THEN
  masking:required_for_testing
  obfuscation:required_for_analytics
END IF
```

## Автоматизация тегирования

### Правила автоматической классификации:

1. **Обнаружение PII:**
   - Паттерны: ФИО, дата рождения, паспорт
   - Автоматический тег: `category:pii`

2. **Обнаружение PHI:**
   - Паттерны: диагнозы, результаты анализов
   - Автоматический тег: `category:phi`

3. **Определение уровня конфиденциальности:**
   - На основе категории и контекста
   - Автоматический тег: `confidentiality:*`

4. **Определение состояния:**
   - На основе места хранения/использования
   - Автоматический тег: `state:*`

## Интеграция с системами безопасности

### RBAC на основе тегов:
- Роль "Врач" → доступ к `category:phi`
- Роль "Ресепшен" → доступ к `category:administrative`
- Роль "Бухгалтерия" → доступ к `category:financial`

### ABAC на основе тегов:
- Атрибут "department:medical" → доступ к `category:phi`
- Атрибут "clearance:high" → доступ к `confidentiality:critical`

### Аудит на основе тегов:
- Все операции с `confidentiality:critical` → полный аудит
- Доступ к `category:phi` → логирование с уведомлениями

